2025/03/09 06:25:42 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:25:42 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:25:42 auth.go:189: Stored CSRF token: 3MPoQLJoCN... (truncated) with expiration: 2025-03-09 07:25:42.5362726 +0600 +06 m=+3600.014860701
2025/03/09 06:25:42 auth.go:143: Generated new CSRF token: 3MPoQLJoCN... (truncated)
2025/03/09 06:25:42 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: 3MPoQLJoCN... from 192.0.2.1:1234
2025/03/09 06:25:42 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:25:42 middleware.go:277: Verifying CSRF token: 3MPoQLJoCN... for path: /api/setup
2025/03/09 06:25:42 auth.go:177: CSRF token verified successfully: 3MPoQLJoCN... (truncated)
2025/03/09 06:25:42 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:25:42 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:25:42 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:25:42 handlers.go:220: SetupVPNHandler: SSH connection verified with test command: 
2025/03/09 06:25:42 handlers.go:272: SetupVPNHandler: Target server is not running Ubuntu: <nil>
2025/03/09 06:25:42 handlers.go:278: SetupVPNHandler: Starting OpenVPN setup
2025/03/09 06:25:42 openvpn.go:21: Starting OpenVPN setup
2025/03/09 06:25:42 openvpn.go:43: Available disk space: 
2025/03/09 06:25:42 openvpn.go:119: Installing packages (attempt 1/3)
2025/03/09 06:25:42 openvpn.go:141: Step 2/6: Setting up PKI infrastructure...
2025/03/09 06:25:42 openvpn.go:173: PKI initialization 1/4: make-cadir ~/easy-rsa
2025/03/09 06:25:43 openvpn.go:173: PKI initialization 2/4: cd ~/easy-rsa && ./easyrsa init-pki
2025/03/09 06:25:43 openvpn.go:173: PKI initialization 3/4: cd ~/easy-rsa && echo 'set_var EASYRSA_KEY_SIZE 2048' > vars
2025/03/09 06:25:44 openvpn.go:173: PKI initialization 4/4: cd ~/easy-rsa && echo 'set_var EASYRSA_DIGEST sha256' >> vars
2025/03/09 06:25:44 openvpn.go:198: Certificate generation 1/4: cd ~/easy-rsa && ./easyrsa --batch build-ca nopass
2025/03/09 06:25:45 openvpn.go:198: Certificate generation 2/4: cd ~/easy-rsa && ./easyrsa --batch gen-req server nopass
2025/03/09 06:25:46 openvpn.go:198: Certificate generation 3/4: cd ~/easy-rsa && ./easyrsa --batch sign-req server server
2025/03/09 06:25:47 openvpn.go:198: Certificate generation 4/4: openssl dhparam -outform PEM -out ~/easy-rsa/dh.pem 2048
2025/03/09 06:25:48 openvpn.go:219: PKI directory contents: 
2025/03/09 06:25:48 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/ca.crt
2025/03/09 06:25:48 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/issued/server.crt
2025/03/09 06:25:48 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/private/server.key
2025/03/09 06:25:48 openvpn.go:243: Verified existence of required file: ~/easy-rsa/dh.pem
2025/03/09 06:25:48 openvpn.go:261: Directory setup 1/2: sudo mkdir -p /etc/openvpn/certs
2025/03/09 06:25:48 openvpn.go:261: Directory setup 2/2: sudo chmod -R 700 /etc/openvpn/certs
2025/03/09 06:25:48 openvpn.go:306: Source file /easy-rsa/pki/ca.crt does not exist: 
2025/03/09 06:25:48 handlers.go:333: SetupVPNHandler: OpenVPN setup failed: source file /easy-rsa/pki/ca.crt not found for copying
2025/03/09 06:25:48 system_metrics.go:100: Error tracked: source file /easy-rsa/pki/ca.crt not found for copying
2025/03/09 06:25:48 http.go:130: Detailed error response: {Error:source file /easy-rsa/pki/ca.crt not found for copying Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:25:48.5410219 +0000 UTC Details: Path:/api/setup}
2025/03/09 06:25:48 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:25:48 auth.go:189: Stored CSRF token: u3JEO7JZsK... (truncated) with expiration: 2025-03-09 07:25:48.5417822 +0600 +06 m=+3606.020370301
2025/03/09 06:25:48 auth.go:143: Generated new CSRF token: u3JEO7JZsK... (truncated)
2025/03/09 06:25:48 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: u3JEO7JZsK... from 192.0.2.1:1234
2025/03/09 06:25:48 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:25:48 middleware.go:277: Verifying CSRF token: u3JEO7JZsK... for path: /api/setup
2025/03/09 06:25:48 auth.go:177: CSRF token verified successfully: u3JEO7JZsK... (truncated)
2025/03/09 06:25:48 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:25:48 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:25:48 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:25:48 handlers.go:220: SetupVPNHandler: SSH connection verified with test command: 
2025/03/09 06:25:48 handlers.go:272: SetupVPNHandler: Target server is not running Ubuntu: <nil>
2025/03/09 06:25:48 handlers.go:371: SetupVPNHandler: Starting iOS VPN (StrongSwan) setup
2025/03/09 06:25:48 strongswan.go:48: Starting StrongSwan setup
2025/03/09 06:25:48 strongswan.go:51: Checking for expired password...
2025/03/09 06:25:48 strongswan.go:100: Available disk space: 
2025/03/09 06:25:48 strongswan.go:104: Generating secure VPN password...
2025/03/09 06:25:48 strongswan.go:109: Secure password generated successfully
2025/03/09 06:25:48 strongswan.go:132: Running cleanup command: sudo killall apt apt-get dpkg
2025/03/09 06:25:50 strongswan.go:132: Running cleanup command: sudo rm -f /var/lib/apt/lists/lock
2025/03/09 06:25:52 strongswan.go:132: Running cleanup command: sudo rm -f /var/cache/apt/archives/lock
2025/03/09 06:25:54 strongswan.go:132: Running cleanup command: sudo rm -f /var/lib/dpkg/lock*
2025/03/09 06:25:56 strongswan.go:132: Running cleanup command: sudo apt-get clean
2025/03/09 06:25:58 strongswan.go:132: Running cleanup command: sudo apt-get autoclean
2025/03/09 06:26:00 strongswan.go:132: Running cleanup command: sudo dpkg --configure -a
2025/03/09 06:26:02 strongswan.go:132: Running cleanup command: sudo rm -rf /var/lib/apt/lists/*
2025/03/09 06:26:04 strongswan.go:132: Running cleanup command: sudo rm -rf /var/cache/apt/archives/*.deb
2025/03/09 06:26:06 strongswan.go:132: Running cleanup command: sudo apt-get update --fix-missing
2025/03/09 06:26:08 strongswan.go:147: Step 1/6: Updating system and installing StrongSwan packages...
2025/03/09 06:26:08 strongswan.go:158: Running command (attempt 1/3): sudo apt-get update
2025/03/09 06:26:10 strongswan.go:158: Running command (attempt 1/3): sudo apt-get install -f
2025/03/09 06:26:12 strongswan.go:158: Running command (attempt 1/3): sudo DEBIAN_FRONTEND=noninteractive apt-get install --no-install-recommends -y strongswan strongswan-pki libcharon-extra-plugins libcharon-extauth-plugins libstrongswan-extra-plugins fail2ban ufw openssl
2025/03/09 06:26:14 strongswan.go:182: Packages installed successfully
2025/03/09 06:26:14 strongswan.go:185: Step 2/6: Generating secure certificates...
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 1/8: sudo mkdir -p /etc/ipsec.d/{cacerts,certs,private}
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 2/8: sudo chmod 700 /etc/ipsec.d/{cacerts,certs,private}
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 3/8: cd /etc/ipsec.d && sudo ipsec pki --gen --type rsa --size 4096 --outform pem > private/ca.key.pem
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 4/8: sudo chmod 600 /etc/ipsec.d/private/ca.key.pem
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 5/8: cd /etc/ipsec.d && sudo ipsec pki --self --ca --lifetime 3650 --in private/ca.key.pem --type rsa --dn 'CN=VPN CA' --outform pem > cacerts/ca.cert.pem
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 6/8: cd /etc/ipsec.d && sudo ipsec pki --gen --type rsa --size 4096 --outform pem > private/server.key.pem
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 7/8: sudo chmod 600 /etc/ipsec.d/private/server.key.pem
2025/03/09 06:26:14 strongswan.go:198: Certificate setup step 8/8: cd /etc/ipsec.d && sudo ipsec pki --pub --in private/server.key.pem | sudo ipsec pki --issue --lifetime 1825 --cacert cacerts/ca.cert.pem --cakey private/ca.key.pem --dn 'CN=192.168.1.1' --san '192.168.1.1' --flag serverAuth --flag ikeIntermediate --outform pem > certs/server.cert.pem
2025/03/09 06:26:14 strongswan.go:207: Certificates generated successfully
2025/03/09 06:26:14 strongswan.go:210: Step 3/6: Creating StrongSwan configuration...
2025/03/09 06:26:14 strongswan.go:248: Writing IPsec configuration file...
2025/03/09 06:26:14 strongswan.go:253: IPsec configuration written successfully
2025/03/09 06:26:14 strongswan.go:256: Step 4/6: Setting up secure secrets...
2025/03/09 06:26:14 strongswan.go:260: Writing IPsec secrets file...
2025/03/09 06:26:14 strongswan.go:265: IPsec secrets written successfully
2025/03/09 06:26:14 strongswan.go:268: Creating directory for VPN configurations...
2025/03/09 06:26:14 strongswan.go:287: VPN config directory setup verified successfully
2025/03/09 06:26:14 strongswan.go:290: Step 5/6: Setting up system security...
2025/03/09 06:26:14 strongswan.go:301: Security step 1/6: sudo chmod 600 /etc/ipsec.secrets
2025/03/09 06:26:14 strongswan.go:301: Security step 2/6: sudo chmod 644 /etc/ipsec.conf
2025/03/09 06:26:14 strongswan.go:301: Security step 3/6: sudo sysctl -w net.ipv4.ip_forward=1
2025/03/09 06:26:14 strongswan.go:301: Security step 4/6: sudo sysctl -w net.ipv4.conf.all.accept_redirects=0
2025/03/09 06:26:14 strongswan.go:301: Security step 5/6: sudo sysctl -w net.ipv4.conf.all.send_redirects=0
2025/03/09 06:26:14 strongswan.go:301: Security step 6/6: sudo sysctl -p
2025/03/09 06:26:14 strongswan.go:309: Security settings applied
2025/03/09 06:26:14 strongswan.go:312: Step 6/6: Starting and enabling StrongSwan service...
2025/03/09 06:26:14 strongswan.go:319: Service step 1/2: sudo systemctl restart strongswan-starter
2025/03/09 06:26:14 strongswan.go:319: Service step 2/2: sudo systemctl enable strongswan-starter
2025/03/09 06:26:14 strongswan.go:330: Verifying StrongSwan service status...
2025/03/09 06:26:14 strongswan.go:342: StrongSwan service is active and running
2025/03/09 06:26:14 strongswan.go:345: Saving VPN credentials...
2025/03/09 06:26:14 strongswan.go:350: VPN credentials saved to /etc/vpn-configs/credentials.txt
2025/03/09 06:26:14 strongswan.go:362: iOS mobileconfig generated at /etc/vpn-configs/d103d2f9-14ba-7fd5-e4e1-9164a22f2559.mobileconfig and linked to /etc/vpn-configs/ios_vpn.mobileconfig
2025/03/09 06:26:14 strongswan.go:365: StrongSwan setup completed successfully
2025/03/09 06:26:14 handlers.go:429: SetupVPNHandler: StrongSwan setup completed successfully
2025/03/09 06:26:14 handlers.go:444: SetupVPNHandler: StrongSwan service is not active, attempting to start
2025/03/09 06:26:17 handlers.go:492: SetupVPNHandler: Config file not found after setup: /etc/vpn-configs/ios_vpn.mobileconfig
2025/03/09 06:26:17 system_metrics.go:100: Error tracked: Internal Server Error: VPN setup completed but config file not found
2025/03/09 06:26:17 http.go:89: Error response: {Error:VPN setup completed but config file not found Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:26:17.7178289 +0000 UTC Details: Path:}
2025/03/09 06:26:17 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:26:17 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:26:17 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:26:17 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:26:17 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:26:17.8096997 +0000 UTC Details: Path:}
2025/03/09 062025/03/09 06:31:47 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:31:47 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:31:47 auth.go:189: Stored CSRF token: Ygob8H2_4X... (truncated) with expiration: 2025-03-09 07:31:47.3662784 +0600 +06 m=+3600.013859701
2025/03/09 06:31:47 auth.go:143: Generated new CSRF token: Ygob8H2_4X... (truncated)
2025/03/09 06:31:47 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: Ygob8H2_4X... from 192.0.2.1:1234
2025/03/09 06:31:47 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:31:47 middleware.go:277: Verifying CSRF token: Ygob8H2_4X... for path: /api/setup
2025/03/09 06:31:47 auth.go:177: CSRF token verified successfully: Ygob8H2_4X... (truncated)
2025/03/09 06:31:47 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:31:47 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:31:47 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:31:47 handlers.go:220: SetupVPNHandler: SSH connection verified with test command: 
2025/03/09 06:31:47 handlers.go:272: SetupVPNHandler: Target server is not running Ubuntu: <nil>
2025/03/09 06:31:47 handlers.go:278: SetupVPNHandler: Starting OpenVPN setup
2025/03/09 06:31:47 openvpn.go:21: Starting OpenVPN setup
2025/03/09 06:31:47 openvpn.go:43: Available disk space: 
2025/03/09 06:31:47 openvpn.go:119: Installing packages (attempt 1/3)
2025/03/09 06:31:47 openvpn.go:141: Step 2/6: Setting up PKI infrastructure...
2025/03/09 06:31:47 openvpn.go:173: PKI initialization 1/4: make-cadir ~/easy-rsa
2025/03/09 06:31:47 openvpn.go:173: PKI initialization 2/4: cd ~/easy-rsa && ./easyrsa init-pki
2025/03/09 06:31:48 openvpn.go:173: PKI initialization 3/4: cd ~/easy-rsa && echo 'set_var EASYRSA_KEY_SIZE 2048' > vars
2025/03/09 06:31:48 openvpn.go:173: PKI initialization 4/4: cd ~/easy-rsa && echo 'set_var EASYRSA_DIGEST sha256' >> vars
2025/03/09 06:31:49 openvpn.go:198: Certificate generation 1/4: cd ~/easy-rsa && ./easyrsa --batch build-ca nopass
2025/03/09 06:31:50 openvpn.go:198: Certificate generation 2/4: cd ~/easy-rsa && ./easyrsa --batch gen-req server nopass
2025/03/09 06:31:51 openvpn.go:198: Certificate generation 3/4: cd ~/easy-rsa && ./easyrsa --batch sign-req server server
2025/03/09 06:31:52 openvpn.go:198: Certificate generation 4/4: openssl dhparam -outform PEM -out ~/easy-rsa/dh.pem 2048
2025/03/09 06:31:53 openvpn.go:219: PKI directory contents: 
2025/03/09 06:31:53 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/ca.crt
2025/03/09 06:31:53 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/issued/server.crt
2025/03/09 06:31:53 openvpn.go:243: Verified existence of required file: ~/easy-rsa/pki/private/server.key
2025/03/09 06:31:53 openvpn.go:243: Verified existence of required file: ~/easy-rsa/dh.pem
2025/03/09 06:31:53 openvpn.go:261: Directory setup 1/2: sudo mkdir -p /etc/openvpn/certs
2025/03/09 06:31:53 openvpn.go:261: Directory setup 2/2: sudo chmod -R 700 /etc/openvpn/certs
2025/03/09 06:31:53 openvpn.go:306: Source file /easy-rsa/pki/ca.crt does not exist: 
2025/03/09 06:31:53 handlers.go:333: SetupVPNHandler: OpenVPN setup failed: source file /easy-rsa/pki/ca.crt not found for copying
2025/03/09 06:31:53 system_metrics.go:100: Error tracked: source file /easy-rsa/pki/ca.crt not found for copying
2025/03/09 06:31:53 http.go:130: Detailed error response: {Error:source file /easy-rsa/pki/ca.crt not found for copying Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:31:53.3710951 +0000 UTC Details: Path:/api/setup}
2025/03/09 06:31:53 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:31:53 auth.go:189: Stored CSRF token: HknJF8wPtH... (truncated) with expiration: 2025-03-09 07:31:53.3720169 +0600 +06 m=+3606.019598201
2025/03/09 06:31:53 auth.go:143: Generated new CSRF token: HknJF8wPtH... (truncated)
2025/03/09 06:31:53 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: HknJF8wPtH... from 192.0.2.1:1234
2025/03/09 06:31:53 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:31:53 middleware.go:277: Verifying CSRF token: HknJF8wPtH... for path: /api/setup
2025/03/09 06:31:53 auth.go:177: CSRF token verified successfully: HknJF8wPtH... (truncated)
2025/03/09 06:31:53 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:31:53 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:31:53 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:31:53 handlers.go:220: SetupVPNHandler: SSH connection verified with test command: 
2025/03/09 06:31:53 handlers.go:272: SetupVPNHandler: Target server is not running Ubuntu: <nil>
2025/03/09 06:31:53 handlers.go:371: SetupVPNHandler: Starting iOS VPN (StrongSwan) setup
2025/03/09 06:31:53 strongswan.go:48: Starting StrongSwan setup
2025/03/09 06:31:53 strongswan.go:51: Checking for expired password...
2025/03/09 06:31:53 strongswan.go:100: Available disk space: 
2025/03/09 06:31:53 strongswan.go:104: Generating secure VPN password...
2025/03/09 06:31:53 strongswan.go:109: Secure password generated successfully
2025/03/09 06:31:53 strongswan.go:132: Running cleanup command: sudo killall apt apt-get dpkg
2025/03/09 06:31:55 strongswan.go:132: Running cleanup command: sudo rm -f /var/lib/apt/lists/lock
2025/03/09 06:31:57 strongswan.go:132: Running cleanup command: sudo rm -f /var/cache/apt/archives/lock
2025/03/09 06:31:59 strongswan.go:132: Running cleanup command: sudo rm -f /var/lib/dpkg/lock*
2025/03/09 06:32:01 strongswan.go:132: Running cleanup command: sudo apt-get clean
2025/03/09 06:32:03 strongswan.go:132: Running cleanup command: sudo apt-get autoclean
2025/03/09 06:32:05 strongswan.go:132: Running cleanup command: sudo dpkg --configure -a
2025/03/09 06:32:07 strongswan.go:132: Running cleanup command: sudo rm -rf /var/lib/apt/lists/*
2025/03/09 06:32:09 strongswan.go:132: Running cleanup command: sudo rm -rf /var/cache/apt/archives/*.deb
2025/03/09 06:32:11 strongswan.go:132: Running cleanup command: sudo apt-get update --fix-missing
2025/03/09 06:32:13 strongswan.go:147: Step 1/6: Updating system and installing StrongSwan packages...
2025/03/09 06:32:13 strongswan.go:158: Running command (attempt 1/3): sudo apt-get update
2025/03/09 06:32:15 strongswan.go:158: Running command (attempt 1/3): sudo apt-get install -f
2025/03/09 06:32:17 strongswan.go:158: Running command (attempt 1/3): sudo DEBIAN_FRONTEND=noninteractive apt-get install --no-install-recommends -y strongswan strongswan-pki libcharon-extra-plugins libcharon-extauth-plugins libstrongswan-extra-plugins fail2ban ufw openssl
2025/03/09 06:32:19 strongswan.go:182: Packages installed successfully
2025/03/09 06:32:19 strongswan.go:185: Step 2/6: Generating secure certificates...
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 1/8: sudo mkdir -p /etc/ipsec.d/{cacerts,certs,private}
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 2/8: sudo chmod 700 /etc/ipsec.d/{cacerts,certs,private}
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 3/8: cd /etc/ipsec.d && sudo ipsec pki --gen --type rsa --size 4096 --outform pem > private/ca.key.pem
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 4/8: sudo chmod 600 /etc/ipsec.d/private/ca.key.pem
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 5/8: cd /etc/ipsec.d && sudo ipsec pki --self --ca --lifetime 3650 --in private/ca.key.pem --type rsa --dn 'CN=VPN CA' --outform pem > cacerts/ca.cert.pem
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 6/8: cd /etc/ipsec.d && sudo ipsec pki --gen --type rsa --size 4096 --outform pem > private/server.key.pem
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 7/8: sudo chmod 600 /etc/ipsec.d/private/server.key.pem
2025/03/09 06:32:19 strongswan.go:198: Certificate setup step 8/8: cd /etc/ipsec.d && sudo ipsec pki --pub --in private/server.key.pem | sudo ipsec pki --issue --lifetime 1825 --cacert cacerts/ca.cert.pem --cakey private/ca.key.pem --dn 'CN=192.168.1.1' --san '192.168.1.1' --flag serverAuth --flag ikeIntermediate --outform pem > certs/server.cert.pem
2025/03/09 06:32:19 strongswan.go:207: Certificates generated successfully
2025/03/09 06:32:19 strongswan.go:210: Step 3/6: Creating StrongSwan configuration...
2025/03/09 06:32:19 strongswan.go:248: Writing IPsec configuration file...
2025/03/09 06:32:19 strongswan.go:253: IPsec configuration written successfully
2025/03/09 06:32:19 strongswan.go:256: Step 4/6: Setting up secure secrets...
2025/03/09 06:32:19 strongswan.go:260: Writing IPsec secrets file...
2025/03/09 06:32:19 strongswan.go:265: IPsec secrets written successfully
2025/03/09 06:32:19 strongswan.go:268: Creating directory for VPN configurations...
2025/03/09 06:32:19 strongswan.go:287: VPN config directory setup verified successfully
2025/03/09 06:32:19 strongswan.go:290: Step 5/6: Setting up system security...
2025/03/09 06:32:19 strongswan.go:301: Security step 1/6: sudo chmod 600 /etc/ipsec.secrets
2025/03/09 06:32:19 strongswan.go:301: Security step 2/6: sudo chmod 644 /etc/ipsec.conf
2025/03/09 06:32:19 strongswan.go:301: Security step 3/6: sudo sysctl -w net.ipv4.ip_forward=1
2025/03/09 06:32:19 strongswan.go:301: Security step 4/6: sudo sysctl -w net.ipv4.conf.all.accept_redirects=0
2025/03/09 06:32:19 strongswan.go:301: Security step 5/6: sudo sysctl -w net.ipv4.conf.all.send_redirects=0
2025/03/09 06:32:19 strongswan.go:301: Security step 6/6: sudo sysctl -p
2025/03/09 06:32:19 strongswan.go:309: Security settings applied
2025/03/09 06:32:19 strongswan.go:312: Step 6/6: Starting and enabling StrongSwan service...
2025/03/09 06:32:19 strongswan.go:319: Service step 1/2: sudo systemctl restart strongswan-starter
2025/03/09 06:32:19 strongswan.go:319: Service step 2/2: sudo systemctl enable strongswan-starter
2025/03/09 06:32:19 strongswan.go:330: Verifying StrongSwan service status...
2025/03/09 06:32:19 strongswan.go:342: StrongSwan service is active and running
2025/03/09 06:32:19 strongswan.go:345: Saving VPN credentials...
2025/03/09 06:32:19 strongswan.go:350: VPN credentials saved to /etc/vpn-configs/credentials.txt
2025/03/09 06:32:19 strongswan.go:362: iOS mobileconfig generated at /etc/vpn-configs/c1de42ee-c0d6-9704-dcb1-c3540a7cc8af.mobileconfig and linked to /etc/vpn-configs/ios_vpn.mobileconfig
2025/03/09 06:32:19 strongswan.go:365: StrongSwan setup completed successfully
2025/03/09 06:32:19 handlers.go:429: SetupVPNHandler: StrongSwan setup completed successfully
2025/03/09 06:32:19 handlers.go:444: SetupVPNHandler: StrongSwan service is not active, attempting to start
2025/03/09 06:32:22 handlers.go:492: SetupVPNHandler: Config file not found after setup: /etc/vpn-configs/ios_vpn.mobileconfig
2025/03/09 06:32:22 system_metrics.go:100: Error tracked: Internal Server Error: VPN setup completed but config file not found
2025/03/09 06:32:22 http.go:89: Error response: {Error:VPN setup completed but config file not found Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:32:22.5446301 +0000 UTC Details: Path:}
2025/03/09 06:32:22 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:32:22 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:32:22 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:32:22 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:32:22 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:32:22.6137959 +0000 UTC Details: Path:}
2025/03/09 062025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:39:20 auth.go:189: Stored CSRF token: KLRLDZdIDH... (truncated) with expiration: 2025-03-09 07:39:20.020441 +0600 +06 m=+3600.014863201
2025/03/09 06:39:20 auth.go:143: Generated new CSRF token: KLRLDZdIDH... (truncated)
2025/03/09 06:39:20 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: KLRLDZdIDH... from 192.0.2.1:1234
2025/03/09 06:39:20 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:39:20 middleware.go:277: Verifying CSRF token: KLRLDZdIDH... for path: /api/setup
2025/03/09 06:39:20 auth.go:177: CSRF token verified successfully: KLRLDZdIDH... (truncated)
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:20 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:39:20 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:39:20 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:20.0209801 +0000 UTC Details: Path:}
2025/03/09 06:39:20 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:39:20 middleware.go:277: Verifying CSRF token: KLRLDZdIDH... for path: /api/setup
2025/03/09 06:39:20 auth.go:177: CSRF token verified successfully: KLRLDZdIDH... (truncated)
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:20 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:39:20 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:39:20 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:20.0215071 +0000 UTC Details: Path:}
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:39:20 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:39:20.1007904 +0000 UTC Details: Path:}
2025/03/09 06:39:20 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 06:39:20 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 06:39:20 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 00:39:20.1013249 +0000 UTC Details: Path:}
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Forbidden: Access denied
2025/03/09 06:39:20 http.go:89: Error response: {Error:Access denied Code:Forbidden RequestID: Timestamp:2025-03-09 00:39:20.2046857 +0000 UTC Details: Path:}
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:39:20 handlers.go:1065: LoginHandler: Login attempt for user: test@example.com
2025/03/09 06:39:20 handlers.go:1093: LoginHandler: Successful login for user: test@example.com
2025/03/09 06:39:20 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:39:20 handlers.go:1059: LoginHandler: Missing credentials
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Bad Request: Missing credentials
2025/03/09 06:39:20 http.go:89: Error response: {Error:Missing credentials Code:Bad Request RequestID: Timestamp:2025-03-09 00:39:20.2052299 +0000 UTC Details: Path:}
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Bad Request: invalid email format
2025/03/09 06:39:20 http.go:89: Error response: {Error:invalid email format Code:Bad Request RequestID: Timestamp:2025-03-09 00:39:20.2614494 +0000 UTC Details: Path:}
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Bad Request: password must be at least 8 characters long
2025/03/09 06:39:20 http.go:89: Error response: {Error:password must be at least 8 characters long Code:Bad Request RequestID: Timestamp:2025-03-09 00:39:20.2614494 +0000 UTC Details: Path:}
2025/03/09 06:39:20 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:112: SetupVPNHandler: Validation error: server_ip is required
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Bad Request: server_ip is required
2025/03/09 06:39:20 http.go:89: Error response: {Error:server_ip is required Code:Bad Request RequestID: Timestamp:2025-03-09 00:39:20.2692917 +0000 UTC Details: Path:}
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:20 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:39:20 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:39:20 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:20.269817 +0000 UTC Details: Path:}
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:20 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:39:20 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:39:20 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:39:20 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:20.2703659 +0000 UTC Details: Path:}
2025/03/09 06:39:20 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:20 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:20 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 1: connection refused
2025/03/09 06:39:20 handlers.go:189: SetupVPNHandler: Waiting 2s before next attempt
2025/03/09 06:39:22 handlers.go:160: SetupVPNHandler: SSH connection attempt 2 of 5 to 192.168.1.1
2025/03/09 06:39:22 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 2: connection refused
2025/03/09 06:39:22 handlers.go:189: SetupVPNHandler: Waiting 4s before next attempt
2025/03/09 06:39:26 handlers.go:160: SetupVPNHandler: SSH connection attempt 3 of 5 to 192.168.1.1
2025/03/09 06:39:26 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 3: connection refused
2025/03/09 06:39:26 handlers.go:189: SetupVPNHandler: Waiting 6s before next attempt
2025/03/09 06:39:32 handlers.go:160: SetupVPNHandler: SSH connection attempt 4 of 5 to 192.168.1.1
2025/03/09 06:39:32 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 4: connection refused
2025/03/09 06:39:32 handlers.go:189: SetupVPNHandler: Waiting 8s before next attempt
2025/03/09 06:39:40 handlers.go:160: SetupVPNHandler: SSH connection attempt 5 of 5 to 192.168.1.1
2025/03/09 06:39:40 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 5: connection refused
2025/03/09 06:39:40 handlers.go:195: SetupVPNHandler: All SSH connection attempts failed after 5 tries
2025/03/09 06:39:40 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection failed after 5 attempts. Connection history:
Attempt 1: connection refused
Attempt 2: connection refused
Attempt 3: connection refused
Attempt 4: connection refused
Attempt 5: connection refused

Please verify:
- The server IP address is correct (192.168.1.1)
- The server is online and reachable
- SSH service is running on the server
- Credentials are valid
- No firewall is blocking the connection

Last error: connection refused
2025/03/09 06:39:40 http.go:89: Error response: {Error:SSH connection failed after 5 attempts. Connection history:
Attempt 1: connection refused
Attempt 2: connection refused
Attempt 3: connection refused
Attempt 4: connection refused
Attempt 5: connection refused

Please verify:
- The server IP address is correct (192.168.1.1)
- The server is online and reachable
- SSH service is running on the server
- Credentials are valid
- No firewall is blocking the connection

Last error: connection refused Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:40.2721968 +0000 UTC Details: Path:}
2025/03/09 06:39:40 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:40 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:39:40 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:39:40 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:39:40 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:39:40 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:39:40.2721968 +0000 UTC Details: Path:}
2025/03/09 06:39:40 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:39:40 handlers.go:112: SetupVPNHandler: Validation error: vpn_type must be 'openvpn' or 'ios2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:49:16 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:49:16 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:49:16 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:49:16 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:49:16 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:49:16.7782153 +0000 UTC Details: Path:}
2025/03/09 06:49:16 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:49:16 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:49:16 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:49:16 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:49:16 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:49:16 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:49:16.7787453 +0000 UTC Details: Path:}
2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:49:16 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:49:16 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:49:16.8562002 +0000 UTC Details: Path:}
2025/03/09 06:49:16 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 06:49:16 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 06:49:16 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 06:49:16 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 00:49:16.8567481 +0000 UTC Details: Path:}
2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 system_metrics.go:100: Error tracked: Forbidden: Access denied
2025/03/09 06:49:16 http.go:89: Error response: {Error:Access denied Code:Forbidden RequestID: Timestamp:2025-03-09 00:49:16.9597737 +0000 UTC Details: Path:}
2025/03/09 06:49:16 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:49:16 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:49:16 handlers.go:1065: LoginHandler: Login attempt for user: test@example.com
2025/03/09 06:49:16 handlers.go:1093: LoginHandler: Suc2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:50:12 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:50:12 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:50:12 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:50:12 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:50:12 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:50:12.8210028 +0000 UTC Details: Path:}
2025/03/09 06:50:12 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:50:12 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:50:12 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:50:12 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:50:12 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:50:12 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:50:12.82208 +0000 UTC Details: Path:}
2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:50:12 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:50:12 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:50:12.8906008 +0000 UTC Details: Path:}
2025/03/09 06:50:12 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 06:50:12 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 06:50:12 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 06:50:12 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 00:50:12.8916896 +0000 UTC Details: Path:}
2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 system_metrics.go:100: Error tracked: Forbidden: Access denied
2025/03/09 06:50:12 http.go:89: Error response: {Error:Access denied Code:Forbidden RequestID: Timestamp:2025-03-09 00:50:12.9960178 +0000 UTC Details: Path:}
2025/03/09 06:50:12 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:50:12 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:50:12 handlers.go:1065: LoginHandler: Login attempt for user: test@example.com
2025/03/09 06:50:12 handlers.go:1093: LoginHandler: Succe2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:52:31 auth.go:189: Stored CSRF token: oXElAUkvgf... (truncated) with expiration: 2025-03-09 07:52:31.604679 +0600 +06 m=+3600.015574501
2025/03/09 06:52:31 auth.go:143: Generated new CSRF token: oXElAUkvgf... (truncated)
2025/03/09 06:52:31 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: oXElAUkvgf... from 192.0.2.1:1234
2025/03/09 06:52:31 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:52:31 middleware.go:277: Verifying CSRF token: oXElAUkvgf... for path: /api/setup
2025/03/09 06:52:31 auth.go:177: CSRF token verified successfully: oXElAUkvgf... (truncated)
2025/03/09 06:52:31 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:31 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:31 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:31 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:31 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:31.6052855 +0000 UTC Details: Path:}
2025/03/09 06:52:31 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:52:31 middleware.go:277: Verifying CSRF token: oXElAUkvgf... for path: /api/setup
2025/03/09 06:52:31 auth.go:177: CSRF token verified successfully: oXElAUkvgf... (truncated)
2025/03/09 06:52:31 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:31 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:31 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:31 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:31 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:31.6058219 +0000 UTC Details: Path:}
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:52:31 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:52:31.791067 +0000 UTC Details: Path:}
2025/03/09 06:52:31 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 06:52:31 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 06:52:31 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 00:52:31.7920742 +0000 UTC Details: Path:}
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Forbidden: Access denied
2025/03/09 06:52:31 http.go:89: Error response: {Error:Access denied Code:Forbidden RequestID: Timestamp:2025-03-09 00:52:31.9035288 +0000 UTC Details: Path:}
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:52:31 handlers.go:1065: LoginHandler: Login attempt for user: test@example.com
2025/03/09 06:52:31 handlers.go:1093: LoginHandler: Successful login for user: test@example.com
2025/03/09 06:52:31 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:52:31 handlers.go:1059: LoginHandler: Missing credentials
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Bad Request: Missing credentials
2025/03/09 06:52:31 http.go:89: Error response: {Error:Missing credentials Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:31.9062407 +0000 UTC Details: Path:}
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Bad Request: invalid email format
2025/03/09 06:52:31 http.go:89: Error response: {Error:invalid email format Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:31.9655625 +0000 UTC Details: Path:}
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Bad Request: password must be at least 8 characters long
2025/03/09 06:52:31 http.go:89: Error response: {Error:password must be at least 8 characters long Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:31.9655625 +0000 UTC Details: Path:}
2025/03/09 06:52:31 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:31 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:31 handlers.go:112: SetupVPNHandler: Validation error: server_ip is required
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Bad Request: server_ip is required
2025/03/09 06:52:31 http.go:89: Error response: {Error:server_ip is required Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:31.9722186 +0000 UTC Details: Path:}
2025/03/09 06:52:31 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:31 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:31 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:31 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:31 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:31 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:31.9727897 +0000 UTC Details: Path:}
2025/03/09 06:52:31 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:31 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:31 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:31 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:31 syst2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 06:52:51 auth.go:189: Stored CSRF token: j1uk7ubRRE... (truncated) with expiration: 2025-03-09 07:52:51.0586208 +0600 +06 m=+3600.015100501
2025/03/09 06:52:51 auth.go:143: Generated new CSRF token: j1uk7ubRRE... (truncated)
2025/03/09 06:52:51 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: j1uk7ubRRE... from 192.0.2.1:1234
2025/03/09 06:52:51 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:52:51 middleware.go:277: Verifying CSRF token: j1uk7ubRRE... for path: /api/setup
2025/03/09 06:52:51 auth.go:177: CSRF token verified successfully: j1uk7ubRRE... (truncated)
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:51 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:51 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:51 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:51.0591507 +0000 UTC Details: Path:}
2025/03/09 06:52:51 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 06:52:51 middleware.go:277: Verifying CSRF token: j1uk7ubRRE... for path: /api/setup
2025/03/09 06:52:51 auth.go:177: CSRF token verified successfully: j1uk7ubRRE... (truncated)
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:51 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:51 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:51 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:51.0596844 +0000 UTC Details: Path:}
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 06:52:51 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 00:52:51.1267062 +0000 UTC Details: Path:}
2025/03/09 06:52:51 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 06:52:51 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 06:52:51 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 00:52:51.1272441 +0000 UTC Details: Path:}
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Forbidden: Access denied
2025/03/09 06:52:51 http.go:89: Error response: {Error:Access denied Code:Forbidden RequestID: Timestamp:2025-03-09 00:52:51.2308299 +0000 UTC Details: Path:}
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:52:51 handlers.go:1065: LoginHandler: Login attempt for user: test@example.com
2025/03/09 06:52:51 handlers.go:1093: LoginHandler: Successful login for user: test@example.com
2025/03/09 06:52:51 handlers.go:1045: LoginHandler: Request received
2025/03/09 06:52:51 handlers.go:1059: LoginHandler: Missing credentials
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Bad Request: Missing credentials
2025/03/09 06:52:51 http.go:89: Error response: {Error:Missing credentials Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:51.2324305 +0000 UTC Details: Path:}
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Bad Request: invalid email format
2025/03/09 06:52:51 http.go:89: Error response: {Error:invalid email format Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:51.2877719 +0000 UTC Details: Path:}
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Bad Request: password must be at least 8 characters long
2025/03/09 06:52:51 http.go:89: Error response: {Error:password must be at least 8 characters long Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:51.2877719 +0000 UTC Details: Path:}
2025/03/09 06:52:51 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:112: SetupVPNHandler: Validation error: server_ip is required
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Bad Request: server_ip is required
2025/03/09 06:52:51 http.go:89: Error response: {Error:server_ip is required Code:Bad Request RequestID: Timestamp:2025-03-09 00:52:51.2966828 +0000 UTC Details: Path:}
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:51 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:51 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:51 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:51.2966828 +0000 UTC Details: Path:}
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:51 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:52:51 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:52:51 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:52:51 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:52:51.297206 +0000 UTC Details: Path:}
2025/03/09 06:52:51 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:52:51 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:52:51 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 1: connection refused
2025/03/09 06:52:51 handlers.go:189: SetupVPNHandler: Waiting 2s before next attempt
2025/03/09 06:52:53 handlers.go:160: SetupVPNHandler: SSH connection attempt 2 of 5 to 192.168.1.1
2025/03/09 06:52:53 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 2: connection refused
2025/03/09 06:52:53 handlers.go:189: SetupVPNHandler: Waiting 4s before next attempt
2025/03/09 06:52:57 handlers.go:160: SetupVPNHandler: SSH connection attempt 3 of 5 to 192.168.1.1
2025/03/09 06:52:57 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 3: connection refused
2025/03/09 06:52:57 handlers.go:189: SetupVPNHandler: Waiting 6s before next attempt
2025/03/09 06:53:03 handlers.go:160: SetupVPNHandler: SSH connection attempt 4 of 5 to 192.168.1.1
2025/03/09 06:53:03 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 4: connection refused
2025/03/09 06:53:03 handlers.go:189: SetupVPNHandler: Waiting 8s before next attempt
2025/03/09 06:53:11 handlers.go:160: SetupVPNHandler: SSH connection attempt 5 of 5 to 192.168.1.1
2025/03/09 06:53:11 handlers.go:184: SetupVPNHandler: SSH connection retry after error: Attempt 5: connection refused
2025/03/09 06:53:11 handlers.go:195: SetupVPNHandler: All SSH connection attempts failed after 5 tries
2025/03/09 06:53:11 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection failed after 5 attempts. Connection history:
Attempt 1: connection refused
Attempt 2: connection refused
Attempt 3: connection refused
Attempt 4: connection refused
Attempt 5: connection refused

Please verify:
- The server IP address is correct (192.168.1.1)
- The server is online and reachable
- SSH service is running on the server
- Credentials are valid
- No firewall is blocking the connection

Last error: connection refused
2025/03/09 06:53:11 http.go:89: Error response: {Error:SSH connection failed after 5 attempts. Connection history:
Attempt 1: connection refused
Attempt 2: connection refused
Attempt 3: connection refused
Attempt 4: connection refused
Attempt 5: connection refused

Please verify:
- The server IP address is correct (192.168.1.1)
- The server is online and reachable
- SSH service is running on the server
- Credentials are valid
- No firewall is blocking the connection

Last error: connection refused Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:53:11.3008577 +0000 UTC Details: Path:}
2025/03/09 06:53:11 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:53:11 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 06:53:11 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 06:53:11 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 06:53:11 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 06:53:11 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 00:53:11.3008577 +0000 UTC Details: Path:}
2025/03/09 06:53:11 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 06:53:11 handlers.go:112: SetupVPNHandler: Validation error: vpn_type must be 'openvpn' or 'io2025/03/09 07:02:18 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:18 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 07:02:18 auth.go:189: Stored CSRF token: Jy9PpdJISw... (truncated) with expiration: 2025-03-09 08:02:18.5359564 +0600 +06 m=+3600.022738401
2025/03/09 07:02:18 auth.go:143: Generated new CSRF token: Jy9PpdJISw... (truncated)
2025/03/09 07:02:18 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: Jy9PpdJISw... from 192.0.2.1:1234
2025/03/09 07:02:18 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:02:18 middleware.go:277: Verifying CSRF token: Jy9PpdJISw... for path: /api/setup
2025/03/09 07:02:18 auth.go:177: CSRF token verified successfully: Jy9PpdJISw... (truncated)
2025/03/09 07:02:18 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:02:18 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:02:18 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:02:18 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:02:18 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:02:18 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:02:18.537033 +0000 UTC Details: Path:}
2025/03/09 07:02:18 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:02:18 middleware.go:277: Verifying CSRF token: Jy9PpdJISw... for path: /api/setup
2025/03/09 07:02:18 auth.go:177: CSRF token verified successfully: Jy9PpdJISw... (truncated)
2025/03/09 07:02:18 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:02:18 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:02:18 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:02:18 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:02:18 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:02:18 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:02:18.537582 +0000 UTC Details: Path:}
2025/03/09 07:02:18 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:18 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:18 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 07:02:18 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 07:02:18 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 01:02:18.6845961 +0000 UTC Details: Path:}
2025/03/09 07:02:18 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 07:02:18 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 07:02:18 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 07:02:18 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 01:02:18.6851615 +0000 UTC Details: Path:}
2025/03/09 07:02:18 config.go:1422025/03/09 07:02:19 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:19 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 07:02:19 auth.go:189: Stored CSRF token: n7ESi4Xfaw... (truncated) with expiration: 2025-03-09 08:02:19.4979225 +0600 +06 m=+3600.021842801
2025/03/09 07:02:19 auth.go:143: Generated new CSRF token: n7ESi4Xfaw... (truncated)
2025/03/09 07:02:19 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: n7ESi4Xfaw... from 192.0.2.1:1234
2025/03/09 07:02:19 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:02:19 middleware.go:277: Verifying CSRF token: n7ESi4Xfaw... for path: /api/setup
2025/03/09 07:02:19 auth.go:177: CSRF token verified successfully: n7ESi4Xfaw... (truncated)
2025/03/09 07:02:19 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:02:19 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:02:19 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:02:19 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:02:19 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:02:19 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:02:19.4984609 +0000 UTC Details: Path:}
2025/03/09 07:02:19 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:02:19 middleware.go:277: Verifying CSRF token: n7ESi4Xfaw... for path: /api/setup
2025/03/09 07:02:19 auth.go:177: CSRF token verified successfully: n7ESi4Xfaw... (truncated)
2025/03/09 07:02:19 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:02:19 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:02:19 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:02:19 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:02:19 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:02:19 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:02:19.4989986 +0000 UTC Details: Path:}
2025/03/09 07:02:19 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:19 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:02:19 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 07:02:19 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 07:02:19 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 01:02:19.5727649 +0000 UTC Details: Path:}
2025/03/09 07:02:19 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 07:02:19 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 07:02:19 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 07:02:19 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 01:02:19.573835 +0000 UTC Details: Path:}
2025/03/09 07:02:19 config.go:142025/03/09 07:07:52 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:52 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 07:07:52 auth.go:189: Stored CSRF token: 4eTn4zOaOL... (truncated) with expiration: 2025-03-09 08:07:52.8545753 +0600 +06 m=+3600.016290601
2025/03/09 07:07:52 auth.go:143: Generated new CSRF token: 4eTn4zOaOL... (truncated)
2025/03/09 07:07:52 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: 4eTn4zOaOL... from 192.0.2.1:1234
2025/03/09 07:07:52 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:07:52 middleware.go:277: Verifying CSRF token: 4eTn4zOaOL... for path: /api/setup
2025/03/09 07:07:52 auth.go:177: CSRF token verified successfully: 4eTn4zOaOL... (truncated)
2025/03/09 07:07:52 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:07:52 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:07:52 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:07:52 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:07:52 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:07:52 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:07:52.8551143 +0000 UTC Details: Path:}
2025/03/09 07:07:52 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:07:52 middleware.go:277: Verifying CSRF token: 4eTn4zOaOL... for path: /api/setup
2025/03/09 07:07:52 auth.go:177: CSRF token verified successfully: 4eTn4zOaOL... (truncated)
2025/03/09 07:07:52 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:07:52 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:07:52 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:07:52 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:07:52 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:07:52 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:07:52.8557191 +0000 UTC Details: Path:}
2025/03/09 07:07:52 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:52 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:52 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 07:07:52 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 07:07:52 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 01:07:52.9196525 +0000 UTC Details: Path:}
2025/03/09 07:07:52 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 07:07:52 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 07:07:52 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 07:07:52 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 01:07:52.9207252 +0000 UTC Details: Path:}
2025/03/09 07:07:52 config.go:12025/03/09 07:07:56 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:56 middleware.go:295: CSRFTokenHandler: Received GET request from 192.0.2.1:1234
2025/03/09 07:07:56 auth.go:189: Stored CSRF token: kSUjAPc85G... (truncated) with expiration: 2025-03-09 08:07:56.6325746 +0600 +06 m=+3600.016493101
2025/03/09 07:07:56 auth.go:143: Generated new CSRF token: kSUjAPc85G... (truncated)
2025/03/09 07:07:56 middleware.go:347: CSRFTokenHandler: Generated token for anonymous user: kSUjAPc85G... from 192.0.2.1:1234
2025/03/09 07:07:56 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:07:56 middleware.go:277: Verifying CSRF token: kSUjAPc85G... for path: /api/setup
2025/03/09 07:07:56 auth.go:177: CSRF token verified successfully: kSUjAPc85G... (truncated)
2025/03/09 07:07:56 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:07:56 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:07:56 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:07:56 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:07:56 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:07:56 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:07:56.6331064 +0000 UTC Details: Path:}
2025/03/09 07:07:56 middleware.go:149: Authentication successful for user test-user accessing /api/setup
2025/03/09 07:07:56 middleware.go:277: Verifying CSRF token: kSUjAPc85G... for path: /api/setup
2025/03/09 07:07:56 auth.go:177: CSRF token verified successfully: kSUjAPc85G... (truncated)
2025/03/09 07:07:56 handlers.go:103: SetupVPNHandler: Processing request
2025/03/09 07:07:56 handlers.go:160: SetupVPNHandler: SSH connection attempt 1 of 5 to 192.168.1.1
2025/03/09 07:07:56 handlers.go:177: SetupVPNHandler: Successfully connected on attempt 1
2025/03/09 07:07:56 handlers.go:216: SetupVPNHandler: SSH connection verification failed: SSH client is not initialized
2025/03/09 07:07:56 system_metrics.go:100: Error tracked: Internal Server Error: SSH connection established but command execution failed: SSH client is not initialized
2025/03/09 07:07:56 http.go:89: Error response: {Error:SSH connection established but command execution failed: SSH client is not initialized Code:Internal Server Error RequestID: Timestamp:2025-03-09 01:07:56.6336407 +0000 UTC Details: Path:}
2025/03/09 07:07:56 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:56 config.go:142: Warning: Failed to initialize database: error pinging database: dial tcp [::1]:5432: connectex: No connection could be made because the target machine actively refused it.
2025/03/09 07:07:56 middleware.go:121: Auth failed: No token provided for /test
2025/03/09 07:07:56 system_metrics.go:100: Error tracked: Unauthorized: Authentication required
2025/03/09 07:07:56 http.go:89: Error response: {Error:Authentication required Code:Unauthorized RequestID: Timestamp:2025-03-09 01:07:56.7047762 +0000 UTC Details: Path:}
2025/03/09 07:07:56 auth.go:102: Error validating JWT: token is malformed: token contains an invalid number of segments
2025/03/09 07:07:56 middleware.go:137: Auth failed: Invalid token for /test: invalid token
2025/03/09 07:07:56 system_metrics.go:100: Error tracked: Unauthorized: Invalid token
2025/03/09 07:07:56 http.go:89: Error response: {Error:Invalid token Code:Unauthorized RequestID: Timestamp:2025-03-09 01:07:56.7053877 +0000 UTC Details: Path:}
2025/03/09 07:07:56 config.go:1